R Code

> library(readxl)
> Russell3000cumreturns <- read_excel("~/UZH/Semester VII/backtestsp500/Russell3000cumreturns.xlsx", 
+     col_types = c("date", "numeric", "numeric", 
+         "numeric"))
> View(Russell3000cumreturns)
> russelldf <- data.frame(Russell3000cumreturns)
> russdf <- melt(russelldf, id = "x", measure = c("y1", "y2", "y3"))
> library(readxl)
> Russell3000cumreturns <- read_excel("~/UZH/Semester VII/backtestsp500/Russell3000cumreturns.xlsx", 
+     col_types = c("date", "numeric", "numeric", 
+         "numeric"))
> View(Russell3000cumreturns)
> russelldf <- data.frame(Russell3000cumreturns)
> russdf <- melt(russelldf, id = "Date", measure = c("Russell3000", "Longshort", "Longonly"))
> plotruss <- ggplot(russdf, aes(Date, value, colour = variable)) + geom_line()
> plotruss
> plotruss <- plotruss + ylab("Cumulative Performance") + xlab("Dates") + scale_y_continuous(labels = scales::percent) + ggtitle("Cumulative Performances compared to S&P500")
> plotruss
> plotruss <- plotruss + ggtitle("Cumulative Performances compared to Russell 3000")
> plotruss
> plotruss1 <- plotruss + theme(legend.position = c(0, 1)) + theme(legend.title = element_blank())
> plotruss1
> 
> plotruss1 <- plotruss + theme(legend.position = c(0.1, 0.9)) + theme(legend.title = element_blank())
> plotruss1
> plotruss1 <- plotruss + theme(legend.position = c(0.2, 0.8)) + theme(legend.title = element_blank())
> plotruss1
> library(readxl)
> SP500cumreturns1 <- read_excel("~/UZH/Semester VII/backtestsp500/SP500cumreturns1.xlsx", 
+     col_types = c("date", "numeric", "numeric", 
+         "numeric"))
> View(SP500cumreturns1)
> sandpdf <- data.frame(SP500cumreturns1)
> spdf <- melt(sandpdf, id = "Date", measure = c("SP500", "Longshort", "Longonly"))
> plotsp <- ggplot(spdf, aes(Date, value, colour = variable)) + geom_line()
> plotsp <- plotsp + ylab("Cumulative Performance") + xlab("Dates") + scale_y_continuous(labels = scales::percent) + ggtitle("Cumulative Performances compared to S&P500")
> plotsp <- plotsp + theme(legend.position = c(0.2, 0.8)) + theme(legend.title = element_blank())
> plotsp
> library(readxl)
> spregression <- read_excel("~/UZH/Semester VII/backtestsp500/spregression.xlsx", 
+     col_types = c("date", "numeric", "numeric", 
+         "numeric", "numeric"))
> View(spregression)
> rmrf <- spregression$`Rm-Rf`
> smb <- spregression$SMB
> hml <- spregression$HML
> longonlysp <- spregression$`Rp-Rf`
> regsplongonly <- lm(longonlysp ~ rmrf + smb + hml)
> library("stargazer", lib.loc="~/R/win-library/3.4")
> stargazer(regsplongonly)
> library(readxl)
> spregressionlongshort <- read_excel("~/UZH/Semester VII/backtestsp500/spregressionlongshort.xlsx")
> View(spregressionlongshort)
> longshort <- spregressionlongshort$`Rp-Rf`
> regsplongshort <- lm(longshort ~ rmrf + smb + hml)
> stargazer(regsplongonly, regsplongshort, align = TRUE)
> library(readxl)
> russellregressionlong <- read_excel("~/UZH/Semester VII/backtestsp500/russellregressionlong.xlsx", 
+     col_types = c("date", "numeric", "numeric", 
+         "numeric", "numeric"))
> View(russellregressionlong)
> russlong <- russellregressionlong$`Rp-Rf`
> regrusslong <- lm(russlong ~ rmrf + smb + hml)
> stargazer(regrusslong)
> library(readxl)
> spregressionlongshort <- read_excel("~/UZH/Semester VII/backtestsp500/spregressionlongshort.xlsx", 
+     col_types = c("date", "numeric", "numeric", 
+         "numeric", "numeric"))
> View(spregressionlongshort)
> longshort <- spregressionlongshort$`Rp-Rf`
> regsplongshort <- lm(longshort ~ rmrf + smb + hml)
> stargazer(regsplongshort)
